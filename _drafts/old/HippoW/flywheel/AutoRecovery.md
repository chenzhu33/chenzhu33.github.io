# AutoRecovery

## 整体逻辑

服务器端定期下发触发规则表

客户端感知到某种问题 --> 查询触发规则表 --> 执行规则表中的action

## 触发

1. 稳定性感知：崩溃、ANR
2. 性能感知：卡顿、内存异常、流量异常
3. 业务感知：视频无法播放、卡片丢失、AR表情素材加载失败
4. 异常感知：catch住的异常、主动抛出的ImeException
5. 链路埋点漏斗异常

## 规则匹配

1. 个例匹配：某一种崩溃10分钟内出现5次、手机长时间卡在某个界面、某一张卡片丢失、词库文件损坏，etc.
2. 通用性匹配：内核版本号、词库版本号、某个lib版本号、rom，etc.

## 动作

1. 主动拉取hotpatch
2. 重新下载词库
3. 下载apk回退
4. 清理数据状态
5. 跳过或切换相关代码
6. 上报

## 提醒

1. 静默修复
2. 提醒用户触发修复